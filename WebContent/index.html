<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>

<HEAD>
    <!--  -->
    <META http-equiv="Content-Type" content="text/html; charset=Big5">
    <META name="GENERATOR" content="IBM Software Development Platform">
    <META http-equiv="Content-Style-Type" content="text/css">
    <TITLE>聊天室 ver0.1</TITLE>
    <!-- <link rel="stylesheet" type="text/css" href="css/main.css"> -->
</HEAD>

<BODY>
    <!-- 聊天室發送訊息外觀 -->
    <div class="box box-flex">
        <input type='text' id='nameInput' class="name" placeholder='暱稱'>
        <input type='text' id='messageInput' class="message box-flex-item" placeholder='消息' autofocus>
        <button id="buttonMessage" name="送出" value="送出">送出</button>
    </div>
    <div class="box">
        <div id='messagesDiv'></div>
    </div>
</BODY>
<script type="text/javascript">
window.onload = function() {
    var strMessage = "";


    document.getElementById("buttonMessage").onclick = function() {
        //建立xhr物件(填入程式碼)
        var xhr = new XMLHttpRequest();
        //設定好回呼函數 
        xhr.onreadystatechange = function() {
            console.log(xhr.status);//Debug
            if (xhr.readyState == 4) {
                if (xhr.status == 200) {
                    //取回...回傳的資料
                    strMessage += xhr.responseText + "\n";
                    document.getElementById("messagesDiv").innerHTML = strMessage;
                } else {
                    alert(xhr.status);
                }
            }
        }

        var data_info = "iptMessage=" + "HI"; //不要寫死
        var url = "ChatMessage.jsp?" + data_info; //直接把資料帶在網址裡面。

        xhr.open("Get", url, true);
        xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
        xhr.send(null);

        document.getElementById("messageInput").value = "";
    }



    // var divObj = document.getElementById("test");
    // var intTest = 1;
    // setInterval(
    //     function() {
    //         intTest++;
    //         divObj.innerHTML = intTest;
    //     },
    //     1000
    // )
};
</script>

</HTML>
